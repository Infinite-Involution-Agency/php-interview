## mq消息丢失原因和解决
发送失败可能是网络异常, 消息服务挂了, 写入失败等 解决的方法:
1. 设置队列配置, 重试次数, 合理的间隔时间
2. 生产端使用同步方法, 确保返回成功
3. 如果使用异步发送的方法, 生产端创建一个本地表用来记录消息发送的状态, 在回调函数根据结果修改本地表的状态, 再通过定时任务, 把失败的消息再此发送
4. 消费端确保接口幂等

## mq消息重复的原因和解决方式
消息重复产生的原因一般是网络原因, 服务异常然后重试产生的, 解决的方法:
1. 每次请求有一个业务上唯一的id, 比如orderId, goodsId, 保证接口幂等性
2. 消费端通过介质保存消息, 比如本地表, redis 过滤掉已经成功处理的消息

## mq消息积压的原因和解决方法
消息积压的原因可能是生产端流量加大, 消费端宕机或者消费速度慢, 解决方法:
1. 加消费者
2. 监控报警及时知道积压

## mq未顺序消费的原因以及解决方法
未顺序消费的原因是:生产者 -> 队列 -> 消费者这三个环节都有可能是多个, 处理的速度也不一样. 不能保证按照生产的顺序消费. 
假设一个订单的 下单->减库存->付款 三部需要顺序消费, 发了三条消息 1.三条消息分发到了不同的队列(分区), 消费者没能顺序消费  2.只有一个队列(分区), 消费者多个线程处理速度不一样
解决方法:
1. 生产者产生消息保证需要顺序处理的消息都落到同一个分区(队列), 可以通过业务id%队列(分区)个数来决定发到哪个队列
2. 生产者产生消息必须是同步的, 异步的话会因为处理时间或者失败重试导致顺序不一致
3. 一个分区(队列)必须只有一个消费者线程, 如果想多个线程消费, 需要在每个线程前自己维持一个队列, 每个队列只处理相同业务id的消息
4. 如果队列(分区)挂了, 或者推送消息失败了, 不能把这条消息分发到别的队列(分区), 这个条线就是挂的状态
